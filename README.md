# FrameForge Cutlist

Макрос для FreeCAD, который автоматически генерирует список раскроя из 3D-модели каркаса, созданной с помощью плагина **FrameForge**.

> Макрос специализирован для работы с конструкциями, построенными в FrameForge, и использует специфичные для этого плагина особенности работы с профилями, поворотами и скосами.

## Что делает макрос

Макрос анализирует видимые элементы в документе FreeCAD и создаёт оптимизированную таблицу раскроя:

### Основная функциональность

1. **Сбор информации о деталях**
   - Сканирует все профилированные объекты в документе
   - Извлекает длину, материал, углы скоса и повороты
   - Группирует одинаковые детали и подсчитывает количество

2. **Таблица деталей**
   - Отображает все уникальные спецификации:
     - Материал (профиль)
     - Длина детали
     - Угол скоса A1 и A2
     - Поворот второго скоса (Rotate2)
     - Количество деталей в проекте
   - Отсортирована по материалу и длине

3. **Оптимизация раскроя**
   - Вычисляет оптимальный раскрой стандартных длин материала
   - Минимизирует отходы с учётом размера пропила (керфа)
   - Показывает для каждого хлыста:
     - Какие детали из него вырезать
     - Размер остатка после раскроя

## Требования

- **FreeCAD** с поддержкой макросов
- **Плагин FrameForge** для создания каркасных конструкций
- Конструкция должна быть построена в FrameForge (объекты должны быть названы по схеме `Profile_<КОД>`, например `Profile_50x50`)
- ~~Объекты должны иметь свойства FrameForge: `TrimAngle1`, `TrimAngle2`, `TrimRotate2` для скосов~~

## Параметры конфигурации

В начале макроса можно настроить:

```python
DEFAULT_MATERIAL = "Профруба"    # Название материала по умолчанию
STOCK_LENGTH = 3000.0            # Стандартная длина хлыста (мм)
KERF = 2.0                       # Размер пропила при раскрое (мм)
ROUND_TO = 1                     # Округление в мм (0.1 = 0.1 мм)
MIN_LENGTH = 10.0                # Минимальная допустимая длина деталей
MAX_LENGTH = 6000.0              # Максимальная допустимая длина деталей
```

## Использование

1. Откройте документ FreeCAD с моделью каркаса
2. Убедитесь, что нужные объекты видимы (иначе они будут пропущены)
3. Запустите макрос
4. Макрос создаст или обновит таблицу "CutList" с раскроем

## Результат

В документе появится новая таблица **CutList** со следующей структурой:

**Часть 1: Список деталей**
- Материал, длина, углы, количество каждой уникальной детали

**Часть 2: План раскроя**
- Для каждого типа материала показывается, как оптимально вырезать все нужные детали из стандартных хлыстов
- Указываются размеры остатков
